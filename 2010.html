<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Happy 20/10</title>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--card-width:320px; --popup-max:420px}
    *{box-sizing:border-box}
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      background: linear-gradient(135deg, aquamarine, lightgreen);
      overflow: hidden;
      color: #fff;
      text-align: center;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    #title {
      font-size: 2.4em;
      margin-top: 8vh;
      text-shadow: 2px 2px 10px rgba(0,0,0,0.2);
      letter-spacing: 1px;
      z-index: 2;
    }
    .heart {
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: red;
      transform: rotate(45deg);
      animation: float 5s linear infinite;
      z-index: 1;
    }
    .heart::before, .heart::after {
      content: "";
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: red;
      border-radius: 50%;
    }
    .heart::before { top: -10px; left: 0; }
    .heart::after  { left: 10px; top: 0; }
    @keyframes float {
      from { transform: translateY(100vh) rotate(45deg); opacity: 1; }
      to   { transform: translateY(-10vh) rotate(45deg); opacity: 0; }
    }
    .message {
      margin-top: 12px;
      font-size: 1.05em;
      max-width: 760px;
      margin-left: auto;
      margin-right: auto;
      z-index: 2;
      position: relative;
      padding: 0 12px;
    }
    #loveBtn {
      margin-top: 22px;
      padding: 12px 22px;
      font-size: 1em;
      border: none;
      border-radius: 999px;
      background-color: rgba(255,255,255,0.95);
      color: #055;
      cursor: pointer;
      transition: transform 0.25s, box-shadow 0.25s;
      position: relative;
      z-index: 3;
    }
    #loveBtn:hover { transform: scale(1.03); box-shadow: 0 6px 18px rgba(0,0,0,0.15); }

    /* Heart effect overlay */
    #heart-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: #000;
      z-index: 30;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    /* Heart animation styles from original file */
    .box {
      width: 100%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      flex-direction: column;
    }
    
    #pinkboard {
      position: relative;
      margin: auto;
      height: 100vh;
      width: 100vw;
    }

    /* Back button */
    #backBtn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1001;
      padding: 12px 24px;
      border: none;
      border-radius: 999px;
      background: #fff;
      color: #b20059;
      cursor: pointer;
      font-weight: bold;
      font-size: 1em;
      transition: transform 0.25s, box-shadow 0.25s;
    }
    #backBtn:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    /* Custom message styling */
    .heart-message {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 35;
      text-align: center;
      color: #ff5ca4;
      font-family: 'Dancing Script', cursive;
      font-size: 2.8rem;
      font-weight: bold;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.7);
      line-height: 1.4;
      width: 90%;
      max-width: 800px;
    }

    /* image */
    .image-container{ 
      position: relative; 
      z-index:2; 
      margin-top:18px;
    }
    .image-container img{ 
      width:260px; 
      border-radius:16px; 
      box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    }

    /* flower styles (for created elements) */
    .flower{ 
      position:absolute; 
      pointer-events:none; 
      font-size:26px; 
      transform:translate(-50%,-50%); 
      animation: popfade 1.5s forwards; 
      z-index:5;
    }
    @keyframes popfade{ 
      0%{ opacity:1; transform:translate(-50%,-50%) scale(0.6)} 
      100%{ opacity:0; transform:translate(-50%,-120%) scale(1.2)} 
    }

    /* responsive tweaks */
    @media (max-width:768px){
      .heart-message {
        font-size: 2rem;
        line-height: 1.3;
      }
    }

    @media (max-width:480px){
      #title { font-size:1.6rem; margin-top:6vh }
      .message { font-size:0.95rem }
      .image-container img{ width:200px }
      .heart-message {
        font-size: 1.6rem;
        line-height: 1.2;
      }
      #backBtn {
        padding: 10px 20px;
        font-size: 0.9em;
        top: 15px;
        right: 15px;
      }
    }
  </style>
</head>
<body>

  <!-- Background music (will play after user interaction in most browsers) -->
  <audio id="bg-music" loop>
    <source src="Tien_Hay_Lui.mp3" type="audio/mpeg">
  </audio>

  <h1 id="title"></h1>

  <!-- Button (as you requested) -->
  <button id="loveBtn">üíñ M·ªùi M·ª° x∆∞ng b·∫•m üíñ</button>

  <!-- Heart effect overlay -->
  <div id="heart-overlay">
    <div class="box">
      <canvas id="pinkboard"></canvas>
    </div>
    <div class="heart-message">
      M·ª° X∆∞ng ∆°i üíñ<br>
      Ch√∫c em y√™u c·ªßa anh c√≥ m·ªôt ng√†y 20-10 h·∫°nh ph√∫c, y√™u th∆∞∆°ng.<br>
      Ch√∫c em lu√¥n m·∫°nh kh·ªèe, an y√™n.
    </div>
    <button id="backBtn">Quay l·∫°i</button>
  </div>

  <!-- image provided by user -->
  <div class="image-container"><img src="bubu_dudu.jpg" alt="Bubu and Dudu"></div>

  <script>
    document.addEventListener('DOMContentLoaded', ()=>{

      // --- Typewriter effect
      const text = "Happy Vietnamese Women's Day";
      const titleEl = document.getElementById('title');
      titleEl.textContent = ''; // ensure empty
      let i = 0;
      function typeWriter(){
        if(i < text.length){
          titleEl.textContent += text.charAt(i);
          i++; setTimeout(typeWriter, 80);
        }
      }
      typeWriter();

      // --- Music (play after user interaction)
      const bg = document.getElementById('bg-music');
      function tryPlayMusic(){
        if(bg.paused){ bg.play().catch(()=>{}); }
        window.removeEventListener('click', tryPlayMusic);
      }
      window.addEventListener('click', tryPlayMusic);

      // --- Floating hearts (background)
      function createHeart(){
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.top = (Math.random() * 60 + 20) + 'vh';
        heart.style.animationDuration = (Math.random() * 3 + 4) + 's';
        document.body.appendChild(heart);
        setTimeout(()=> heart.remove(), 7000);
      }
      const heartInterval = setInterval(createHeart, 900);

      // --- Flower burst on clicks (except for button)
      function createFlower(x,y){
        const f = document.createElement('div');
        f.className = 'flower';
        f.style.left = x + 'px';
        f.style.top = y + 'px';
        f.textContent = 'üå∏';
        document.body.appendChild(f);
        setTimeout(()=> f.remove(), 1600);
      }
      document.addEventListener('click', (e)=>{
        const target = e.target;
        // ignore when clicking button
        if(target.id === 'loveBtn' || target.closest('#heart-overlay')) return;
        createFlower(e.clientX, e.clientY);
      });

      // --- Heart effect integration (from your file)
      function startHeartEffect(){
        const heartOverlay = document.getElementById('heart-overlay');
        heartOverlay.style.display = 'flex';
        
        // Initialize heart animation
        initializeHeartAnimation();
      }

      // Back button functionality
      document.getElementById('backBtn').addEventListener('click', () => {
        const heartOverlay = document.getElementById('heart-overlay');
        heartOverlay.style.display = 'none';
      });

      // Add event listener for heart effect
      document.getElementById('loveBtn').addEventListener('click', startHeartEffect);

      // cleanup on unload (stop intervals)
      window.addEventListener('beforeunload', ()=> clearInterval(heartInterval));

    });

    // Heart animation code from your file (minimal changes)
    function initializeHeartAnimation() {
      /*
      * Settings
      */
      var settings = {
        particles: {
          length: 2000, // maximum amount of particles
          duration: 2, // particle duration in sec
          velocity: 100, // particle velocity in pixels/sec
          effect: -1.3, // play with this for a nice effect
          size: 13, // particle size in pixels
        },
      };

      /*
      * RequestAnimationFrame polyfill by Erik M√∂ller
      */
      (function(){var b=0;var c=["ms","moz","webkit","o"];for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(h,e){var d=new Date().getTime();var f=Math.max(0,16-(d-b));var g=window.setTimeout(function(){h(d+f)},f);b=d+f;return g}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(d){clearTimeout(d)}}}());

      /*
      * Point class
      */
      var Point = (function() {
        function Point(x, y) {
          this.x = (typeof x !== 'undefined') ? x : 0;
          this.y = (typeof y !== 'undefined') ? y : 0;
        }
        Point.prototype.clone = function() {
          return new Point(this.x, this.y);
        };
        Point.prototype.length = function(length) {
          if (typeof length == 'undefined')
            return Math.sqrt(this.x * this.x + this.y * this.y);
          this.normalize();
          this.x *= length;
          this.y *= length;
          return this;
        };
        Point.prototype.normalize = function() {
          var length = this.length();
          this.x /= length;
          this.y /= length;
          return this;
        };
        return Point;
      })();

      /*
      * Particle class
      */
      var Particle = (function() {
        function Particle() {
          this.position = new Point();
          this.velocity = new Point();
          this.acceleration = new Point();
          this.age = 0;
        }
        Particle.prototype.initialize = function(x, y, dx, dy) {
          this.position.x = x;
          this.position.y = y;
          this.velocity.x = dx;
          this.velocity.y = dy;
          this.acceleration.x = dx * settings.particles.effect;
          this.acceleration.y = dy * settings.particles.effect;
          this.age = 0;
        };
        Particle.prototype.update = function(deltaTime) {
          this.position.x += this.velocity.x * deltaTime;
          this.position.y += this.velocity.y * deltaTime;
          this.velocity.x += this.acceleration.x * deltaTime;
          this.velocity.y += this.acceleration.y * deltaTime;
          this.age += deltaTime;
        };
        Particle.prototype.draw = function(context, image) {
          function ease(t) {
            return (--t) * t * t + 1;
          }
          var size = image.width * ease(this.age / settings.particles.duration);
          context.globalAlpha = 1 - this.age / settings.particles.duration;
          context.drawImage(image, this.position.x - size / 2, this.position.y - size / 2, size, size);
        };
        return Particle;
      })();

      /*
      * ParticlePool class
      */
      var ParticlePool = (function() {
        var particles,
          firstActive = 0,
          firstFree = 0,
          duration = settings.particles.duration;

        function ParticlePool(length) {
          // create and populate particle pool
          particles = new Array(length);
          for (var i = 0; i < particles.length; i++)
            particles[i] = new Particle();
        }

        ParticlePool.prototype.add = function(x, y, dx, dy) {
          particles[firstFree].initialize(x, y, dx, dy);

          // handle circular queue
          firstFree++;
          if (firstFree == particles.length) firstFree = 0;
          if (firstActive == firstFree ) firstActive++;
          if (firstActive == particles.length) firstActive = 0;
        };

        ParticlePool.prototype.update = function(deltaTime) {
          var i;

          // update active particles
          if (firstActive < firstFree) {
            for (i = firstActive; i < firstFree; i++)
              particles[i].update(deltaTime);
          }
          if (firstFree < firstActive) {
            for (i = firstActive; i < particles.length; i++)
              particles[i].update(deltaTime);
            for (i = 0; i < firstFree; i++)
              particles[i].update(deltaTime);
          }

          // remove inactive particles
          while (particles[firstActive].age >= duration && firstActive != firstFree) {
            firstActive++;
            if (firstActive == particles.length) firstActive = 0;
          }
        };

        ParticlePool.prototype.draw = function(context, image) {
          // draw active particles
          if (firstActive < firstFree) {
            for (i = firstActive; i < firstFree; i++)
              particles[i].draw(context, image);
          }
          if (firstFree < firstActive) {
            for (i = firstActive; i < particles.length; i++)
              particles[i].draw(context, image);
            for (i = 0; i < firstFree; i++)
              particles[i].draw(context, image);
          }
        };

        return ParticlePool;
      })();

      /*
      * Putting it all together
      */
      (function(canvas) {
        var context = canvas.getContext('2d'),
          particles = new ParticlePool(settings.particles.length),
          particleRate = settings.particles.length / settings.particles.duration, // particles/sec
          time;

        // get point on heart with -PI <= t <= PI
        function pointOnHeart(t) {
          return new Point(
            160 * Math.pow(Math.sin(t), 3),
            130 * Math.cos(t) - 50 * Math.cos(2 * t) - 20 * Math.cos(3 * t) - 10 * Math.cos(4 * t) + 25
          );
        }

        // creating the particle image using a dummy canvas
        var image = (function() {
          var canvas = document.createElement('canvas'),
            context = canvas.getContext('2d');
          canvas.width = settings.particles.size;
          canvas.height = settings.particles.size;

          // helper function to create the path
          function to(t) {
            var point = pointOnHeart(t);
            point.x = settings.particles.size / 2 + point.x * settings.particles.size / 350;
            point.y = settings.particles.size / 2 - point.y * settings.particles.size / 350;
            return point;
          }

          // create the path
          context.beginPath();
          var t = -Math.PI;
          var point = to(t);
          context.moveTo(point.x, point.y);
          while (t < Math.PI) {
            t += 0.01; // baby steps!
            point = to(t);
            context.lineTo(point.x, point.y);
          }
          context.closePath();

          // create the fill
          context.fillStyle = '#FF5CA4';
          context.fill();

          // create the image
          var image = new Image();
          image.src = canvas.toDataURL();
          return image;
        })();

        // render that thing!
        function render() {
          // next animation frame
          requestAnimationFrame(render);

          // update time
          var newTime = new Date().getTime() / 1000,
            deltaTime = newTime - (time || newTime);
          time = newTime;

          // clear canvas
          context.clearRect(0, 0, canvas.width, canvas.height);

          // create new particles
          var amount = particleRate * deltaTime;
          for (var i = 0; i < amount; i++) {
            var pos = pointOnHeart(Math.PI - 2 * Math.PI * Math.random());
            var dir = pos.clone().length(settings.particles.velocity);
            particles.add(canvas.width / 2 + pos.x, canvas.height / 2 - pos.y, dir.x, -dir.y);
          }

          // update and draw particles
          particles.update(deltaTime);
          particles.draw(context, image);
        }

        // handle (re-)sizing of the canvas
        function onResize() {
          canvas.width = canvas.clientWidth;
          canvas.height = canvas.clientHeight;
        }
        window.onresize = onResize;

        // delay rendering bootstrap
        setTimeout(function() {
          onResize();
          render();
        }, 10);
      })(document.getElementById('pinkboard'));
    }
  </script>

</body>
</html>